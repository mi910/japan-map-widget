<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <title>日本地図ウィジェット</title>
  <script src="https://cdn.amcharts.com/lib/5/index.js"></script>
  <script src="https://cdn.amcharts.com/lib/5/map.js"></script>
  <script src="https://cdn.amcharts.com/lib/5/geodata/japanLow.js"></script>
  <style>
    html, body { margin: 0; height: 100%; }
    #chartdiv { width: 100%; height: 100vh; }
  </style>
</head>
<body>
  <div id="chartdiv"></div>

  <script>
    am5.ready(function() {
      var root = am5.Root.new("chartdiv");
  
      var chart = root.container.children.push(
        am5map.MapChart.new(root, {
          panX: "true", panY: "false", projection: am5map.geoMercator()
        })
      );
  
      var polygonSeries = chart.series.push(
        am5map.MapPolygonSeries.new(root, {
          geoJSON: am5geodata_japanLow
        })
      );
  
      polygonSeries.mapPolygons.template.setAll({
        tooltipText: "{name}：クリックで詳細へ",
        interactive: true,
        fill: am5.color(0xcccccc), // デフォルト色：グレー
        stroke: am5.color(0xffffff),
        strokeWidth: 1
      });
  
      // Notionリンク：契約済み都道府県だけ設定
      const notionLinks = {
        "JP-01": "https://www.notion.so/1ec00cf1d7418007bc8ddbae43d8eb4d?pvs=4", // 北海道
        "JP-02": "https://www.notion.so/1ec00cf1d74180eda165cbda1baf5a1f?pvs=4", // 青森県
        "JP-03": "", // 岩手県
        "JP-04": "", // 宮城県
        "JP-05": "", // 秋田県
        "JP-06": "", // 山形県
        "JP-07": "", // 福島県
        "JP-08": "", // 茨城県
        "JP-09": "", // 栃木県
        "JP-10": "", // 群馬県
        "JP-11": "", // 埼玉県
        "JP-12": "", // 千葉県
        "JP-13": "", // 東京都
        "JP-14": "", // 神奈川県
        "JP-15": "", // 新潟県
        "JP-16": "", // 富山県
        "JP-17": "", // 石川県
        "JP-18": "", // 福井県
        "JP-19": "", // 山梨県
        "JP-20": "", // 長野県
        "JP-21": "", // 岐阜県
        "JP-22": "", // 静岡県
        "JP-23": "", // 愛知県
        "JP-24": "", // 三重県
        "JP-25": "", // 滋賀県
        "JP-26": "", // 京都府
        "JP-27": "", // 大阪府
        "JP-28": "", // 兵庫県
        "JP-29": "", // 奈良県
        "JP-30": "", // 和歌山県
        "JP-31": "", // 鳥取県
        "JP-32": "", // 島根県
        "JP-33": "", // 岡山県
        "JP-34": "", // 広島県
        "JP-35": "", // 山口県
        "JP-36": "", // 徳島県
        "JP-37": "", // 香川県
        "JP-38": "", // 愛媛県
        "JP-39": "", // 高知県
        "JP-40": "", // 福岡県
        "JP-41": "", // 佐賀県
        "JP-42": "", // 長崎県
        "JP-43": "", // 熊本県
        "JP-44": "", // 大分県
        "JP-45": "", // 宮崎県
        "JP-46": "", // 鹿児島県
        "JP-47": ""  // 沖縄県
      };
  
      // 色をつけたい契約済み都道府県の色
      const contractedColor = am5.color(0x4CAF93);
  
      // 色分け適用
      polygonSeries.events.on("datavalidated", function () {
        polygonSeries.mapPolygons.each(function(polygon) {
          const id = polygon.dataItem.dataContext.id;
          if (notionLinks[id]) {
            polygon.set("fill", contractedColor);
          }
        });
      });
  
      // クリックで Notion へ遷移
      polygonSeries.mapPolygons.template.events.on("click", function(ev) {
        const id = ev.target.dataItem.dataContext.id;
        const url = notionLinks[id];
        if (url) {
          window.open(url, "_blank");
        } else {
          alert("Notionリンクが未設定です: " + id);
        }
      });
    });
  </script>
  
  
</body>
</html>
